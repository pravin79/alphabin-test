{% extends "home.html" %} {% block content %}
<head>
  <link rel="stylesheet" href="static/assets/css/order-confirmation.css" />
</head>

<section id="orderConfirmationSection" class="container-fluid">
  <div class="order-confirmation">
    <h2>Order Confirmation</h2>
    <div class="order-summary">
      <h3>Order Summary</h3>
      <div class="product-container">
        <div class="product">
          <img src="../assets/imgs/api.png" alt="Product 1" />
          <div class="product-details">
            <h4 id="productName">API Automation Testing</h4>
            <h5 id="productPrice">$25,000</h5>
          </div>
        </div>
      </div>
    </div>
    <div style="display: flex">
      <div class="shipping-info">
        <h3>Shipping Information</h3>
        <p id="fullname">{{userdata.fullname}}</p>
        <p id="city">{{userdata.city}}</p>
        <p id="state">
          {{userdata.state}}, {{userdata.country}}-{{userdata.zipcode}}
        </p>
        <p>Email: {{userdata.email}}</p>
      </div>
      <div class="payment-info">
        <h3>Payment Information</h3>
        <p>Credit Card: {{userdata.cardnumber}}</p>
        <p>Expiration Date: {{userdata.month}}-{{userdata.year}}</p>
        <p>Billing Address</p>
        <p id="billingCity">{{userdata.city}}</p>
        <p id="billingState">
          {{userdata.state}}, {{userdata.country}}-{{userdata.zipcode}}
        </p>
      </div>
    </div>
    <div class="confirmation-message">
      <p>Thank you for your order!</p>
      <p id="order-id"></p>
    </div>
  </div>
</section>

<script>
  const decrementBtn = document.querySelector(".decrement");
  const incrementBtn = document.querySelector(".increment");
  const quantityInput = document.querySelector('input[type="number"]');

  decrementBtn.addEventListener("click", () => {
    let currentValue = parseInt(quantityInput.value);
    if (currentValue > 1) {
      quantityInput.value = --currentValue;
    }
  });

  incrementBtn.addEventListener("click", () => {
    let currentValue = parseInt(quantityInput.value);
    if (currentValue < parseInt(quantityInput.getAttribute("max"))) {
      quantityInput.value = ++currentValue;
    }
  });

  const fs = require("fs");
  const path = require("path");

  function generateUniqueOrderId(filePath) {
    try {
      const lastOrderId = parseInt(fs.readFileSync(filePath, "utf8").trim());

      const newOrderId = lastOrderId + 1;

      fs.writeFileSync(filePath, newOrderId.toString());

      return newOrderId;
    } catch (err) {
      const initialOrderId = 1000;
      fs.writeFileSync(filePath, initialOrderId.toString());
      return initialOrderId;
    }
  }

  const filePath = path.join(__dirname, "lastOrderId.txt");

  const orderId = generateUniqueOrderId(filePath);

  const orderIdElement = document.getElementById("order-id");
  orderIdElement.textContent = `Order ID: #GF${orderId}`;
</script>

{% endblock %}
